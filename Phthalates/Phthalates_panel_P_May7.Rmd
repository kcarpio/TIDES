---
title: "Phthalates panel, protein biomarkers (Empiria) and transcripts"
author: "KC"
date: "5/7/2021"
output: html_document
---

Placental phthalates show AAPrev, urinary pthalates show AAPmono

lnAAPrev_nor: Summary placental phthalate measurement, normalized to placental weight (ln=ln-transformed) <br/>
lnAAPmonosg: Summary urinary phthalate measurement, normalized to specific gravity (ln=ln-transformed)

data: total-tides.csv

# Protein

```{r, echo=FALSE, message=FALSE, warning=FALSE}

library(readxl)
bo <- read_excel("/Users/kcarpio/Desktop/boo.xlsx")

bo$Tissue <- as.factor(bo$Tissue)
bo$BabySex <- as.factor(bo$BabySex)
bo$Sample <- as.factor(bo$Sample)

library(lme4)
library(lmerTest)
library(ggplot2)

# Placental phthalates

qplot(AAPrev_lnp, PPARg.empl, data=bo, color = Sample, linetype = BabySex,geom='point') +  
  geom_smooth(aes(group=interaction(BabySex)), method = "lm", color = "black" , size = 0.7) + 
  facet_grid(.~Tissue)+theme_bw() + ggtitle("PPARg") + 
  theme(axis.title.x = element_blank(), axis.title.y = element_blank()) + 
  theme(plot.title = element_text(face = "bold"), axis.text.x = element_text(size=10, face="bold", colour = "black"), axis.text.y = element_text(size=10, face="bold", colour = "black"), strip.text.x = element_blank()) + 
  ylim(5, 10) + guides(linetype=guide_legend("Fetal Sex"), color = FALSE) + 
  theme(legend.text = element_text(size=10, 
                                   face="bold"))+
  theme(legend.title = element_text(size=10, 
                                    face="bold"))+
  scale_linetype_discrete(name="Fetal\nSex",
                          breaks=c("1", "2"),
                          labels=c("Male", "Female"))


qplot(AAPrev_lnp, hCGa.empl, data=bo, color = Sample, linetype = BabySex,geom='point') +  
  geom_smooth(aes(group=interaction(BabySex)), method = "lm", color = "black" , size = 0.7) + 
  facet_grid(.~Tissue)+theme_bw() + ggtitle("hCGa") + 
  theme(axis.title.x = element_blank(), axis.title.y = element_blank()) + 
  theme(plot.title = element_text(face = "bold"), axis.text.x = element_text(size=15, face="bold", colour = "black"), axis.text.y = element_text(size=15, face="bold", colour = "black"), strip.text.x = element_blank()) + 
  ylim(5, 10) + guides(linetype=guide_legend("Fetal Sex"), color = FALSE) + 
  theme(legend.text = element_text(size=15, 
                                   face="bold"))+
  theme(legend.title = element_text(size=15, 
                                    face="bold")) +
  scale_linetype_discrete(name="Fetal\nSex",
                          breaks=c("1", "2"),
                          labels=c("Male", "Female"))


qplot(AAPrev_lnp, hCGb.empl, data=bo, color = Sample, linetype = BabySex,geom='point') +  
  geom_smooth(aes(group=interaction(BabySex)), method = "lm", color = "black" , size = 0.7) + 
  facet_grid(.~Tissue)+theme_bw() + ggtitle("hCGb") + 
  theme(axis.title.x = element_blank(), axis.title.y = element_blank()) + 
  theme(plot.title = element_text(face = "bold"), axis.text.x = element_text(size=15, face="bold", colour = "black"), axis.text.y = element_text(size=15, face="bold", colour = "black"), strip.text.x = element_blank()) + 
  ylim(5, 10) + guides(linetype=guide_legend("Fetal Sex"), color = FALSE) + 
  theme(legend.text = element_text(size=15, 
                                   face="bold"))+
  theme(legend.title = element_text(size=15, 
                                    face="bold")) +
  scale_linetype_discrete(name="Fetal\nSex",
                          breaks=c("1", "2"),
                          labels=c("Male", "Female"))

```

# Transcripts

```{r echo=FALSE, message=FALSE, warning=FALSE}

library(readxl)
bo <- read_excel("/Users/kcarpio/Desktop/boo.xlsx")

bo$Tissue <- as.factor(bo$Tissue)
bo$BabySex <- as.factor(bo$BabySex)
bo$Sample <- as.factor(bo$Sample)

library(lme4)
library(lmerTest)
library(ggplot2)

# First trimester urinary

qplot(AAPrev_lnp, CGA.n, data=bo, color = Sample, linetype = BabySex,geom='point') +  
  geom_smooth(aes(group=interaction(BabySex)), method = "lm", color = "black" , size = 0.7) + 
  facet_grid(.~Tissue)+theme_bw() + ggtitle("CGA") + 
  theme(axis.title.x = element_blank(), axis.title.y = element_blank()) + 
  theme(plot.title = element_text(face = "bold"), axis.text.x = element_text(size=10, face="bold", colour = "black"), axis.text.y = element_text(size=10, face="bold", colour = "black"), strip.text.x = element_blank()) + 
  ylim(-0.25, 2) + guides(linetype=guide_legend("Fetal Sex"), color = FALSE) + 
  theme(legend.text = element_text(size=10, 
                                   face="bold"))+
  theme(legend.title = element_text(size=10, 
                                    face="bold")) +
  scale_linetype_discrete(name="Fetal\nSex",
                          breaks=c("1", "2"),
                          labels=c("Male", "Female"))+
  theme(axis.text = element_text(size = 10)) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        strip.background = element_blank(),
        panel.border = element_rect(colour = "black", fill = NA))+
  theme(panel.spacing = unit(1, "lines"))



qplot(AAPrev_lnp, CGA.n, data=bo, color = Sample, linetype = BabySex,geom='point') +  
  geom_smooth(aes(group=interaction(BabySex)), method = "lm", color = "black" , size = 0.7) + 
  facet_grid(.~Tissue)+theme_bw() + ggtitle("CGB") + 
  theme(axis.title.x = element_blank(), axis.title.y = element_blank()) + 
  theme(plot.title = element_text(face = "bold"), axis.text.x = element_text(size=10, face="bold", colour = "black"), axis.text.y = element_text(size=10, face="bold", colour = "black"), strip.text.x = element_blank()) + 
  ylim(-0.25, 2) + guides(linetype=guide_legend("Fetal Sex"), color = FALSE) + 
  theme(legend.text = element_text(size=10, 
                                   face="bold"))+
  theme(legend.title = element_text(size=10, 
                                    face="bold")) +
  scale_linetype_discrete(name="Fetal\nSex",
                          breaks=c("1", "2"),
                          labels=c("Male", "Female"))+
  theme(axis.text = element_text(size = 10)) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        strip.background = element_blank(),
        panel.border = element_rect(colour = "black", fill = NA))+
  theme(panel.spacing = unit(1, "lines"))


qplot(AAPrev_lnp, SNORA46.SDHA, data=bo, color = Sample, linetype = BabySex,geom='point') +  
  geom_smooth(aes(group=interaction(BabySex)), method = "lm", color = "black" , size = 0.7) + 
  facet_grid(.~Tissue)+theme_bw() + ggtitle("SNORA46") + 
  theme(axis.title.x = element_blank(), axis.title.y = element_blank()) + 
  theme(plot.title = element_text(face = "bold"), axis.text.x = element_text(size=10, face="bold", colour = "black"), axis.text.y = element_text(size=10, face="bold", colour = "black"), strip.text.x = element_blank()) + 
  ylim(-1, 1) + guides(linetype=guide_legend("Fetal Sex"), color = FALSE) + 
  theme(legend.text = element_text(size=10, 
                                   face="bold"))+
  theme(legend.title = element_text(size=10, 
                                    face="bold")) +
  scale_linetype_discrete(name="Fetal\nSex",
                          breaks=c("1", "2"),
                          labels=c("Male", "Female"))+
  theme(axis.text = element_text(size = 10)) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        strip.background = element_blank(),
        panel.border = element_rect(colour = "black", fill = NA))+
  theme(panel.spacing = unit(1, "lines"))


qplot(AAPrev_lnp, PPARg.SDHA, data=bo, color = Sample, linetype = BabySex,geom='point') +  
  geom_smooth(aes(group=interaction(BabySex)), method = "lm", color = "black" , size = 0.7) + 
  facet_grid(.~Tissue)+theme_bw() + ggtitle("PPARg") + 
  theme(axis.title.x = element_blank(), axis.title.y = element_blank()) + 
  theme(plot.title = element_text(face = "bold"), axis.text.x = element_text(size=10, face="bold", colour = "black"), axis.text.y = element_text(size=10, face="bold", colour = "black"), strip.text.x = element_blank()) + 
  ylim(-1, 1) + guides(linetype=guide_legend("Fetal Sex"), color = FALSE) + 
  theme(legend.text = element_text(size=10, 
                                   face="bold"))+
  theme(legend.title = element_text(size=10, 
                                    face="bold")) +
  scale_linetype_discrete(name="Fetal\nSex",
                          breaks=c("1", "2"),
                          labels=c("Male", "Female"))+
  theme(axis.text = element_text(size = 10)) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        strip.background = element_blank(),
        panel.border = element_rect(colour = "black", fill = NA))+
  theme(panel.spacing = unit(1, "lines"))


```
